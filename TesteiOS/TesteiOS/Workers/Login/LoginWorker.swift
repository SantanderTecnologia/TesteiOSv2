//
//  LoginWorker.swift
//  TesteiOS
//
//  Created by Fernando Gomes on 14/06/19.
//  Copyright (c) 2019 Fernando Gomes. All rights reserved.
//
//  This file was generated by the Clean Swift Xcode Templates so
//  you can apply clean architecture to your iOS and Mac projects,
//  see http://clean-swift.com
//

import UIKit

class LoginWorker
{
    func doLogin(request: Login.doLogin.Request, callback: @escaping (_ request: Login.doLogin.Response?) -> Void) {
        if !(request.user.isValidEmail || request.user.isValidCpf) {
            let response = Login.doLogin.Response(userAccount: nil, error: ["Login failed":"You have entered an invalid email / CPF or password"])
            callback(response)
        } else if !(request.password.isValidPassword) {
            let response = Login.doLogin.Response(userAccount: nil, error: ["Login failed": "You have entered an invalid email / CPF or password"])
            callback(response)
        } else {
            RestApi.doLogin(user: request.user, password: request.password, callback: { response in
                let response = Login.doLogin.Response(userAccount: response!, error: nil)
                callback(response)
            }, error: {})
        }
  }
}
